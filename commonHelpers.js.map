{"version":3,"file":"commonHelpers.js","sources":["../src/js/card.js"],"sourcesContent":["import axios from 'axios';\n// import { createNewOrder } from './get-api';\n\nconst STORAGE_KEY = 'added-item';\nlet dataForm = [];\n\nconst itemCount = document.querySelector('.js-item-count');\nconst emptyBasket = document.querySelector('.js-empty-basket');\nconst filledBasket = document.querySelector('.js-filled-basket');\nconst itemsContainer = document.querySelector('.js-items-container');\nconst totalSum = document.querySelector('.total-count-text');\nconst checkoutForm = document.querySelector('.js-checkout-form');\nconst itemButton = document.querySelector('.js-item-button');\n\ncheckoutForm.addEventListener('submit', onOrderSubmit);\nitemButton.addEventListener('click', onClick);\n\naddLocalStorageData();\n\nfunction addLocalStorageData() {\n  dataForm = [\n    {\n      _id: '640c2dd963a319ea671e37d4',\n      name: 'Banana',\n      img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e37d4.png',\n      category: 'Fresh_Produce',\n      price: 0.69,\n      size: '1 piece',\n      is10PercentOff: true,\n      popularity: 108,\n    },\n    {\n      _id: '640c2dd963a319ea671e383b',\n      name: 'Ackee',\n      img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e383b.png',\n      category: 'Fresh_Produce',\n      price: 8.99,\n      size: '16 oz',\n      is10PercentOff: false,\n      popularity: 0,\n    },\n    {\n      _id: '640c2dd963a319ea671e3864',\n      name: 'Black Beans',\n      img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e3864.png',\n      category: 'Pantry_Items',\n      price: 1.99,\n      size: '16oz',\n      is10PercentOff: false,\n      popularity: 0,\n    },\n    {\n      _id: '640c2dd963a319ea671e37ad',\n      name: 'Black Olives',\n      img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e37ad.png',\n      category: 'Fresh_Produce',\n      price: 3.99,\n      size: '1 jar (16 oz)',\n      is10PercentOff: false,\n      popularity: 0,\n    },\n  ];\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(dataForm));\n}\n\nonLoad();\n\nfunction onLoad() {\n  try {\n    getLocalStorageData();\n    countAddedItems(dataForm);\n    itemsContainer.innerHTML = basketItemsMarkup(dataForm);\n    totalSumCount(dataForm);\n    // totalSum.textContent = `$${totalSumCount(dataForm)}`;\n  } catch (error) {\n    // add notifix message about something wrong\n    console.log(error.message);\n  }\n}\n\nfunction getLocalStorageData() {\n  const data = localStorage.getItem(STORAGE_KEY);\n  if (!data) return;\n  dataForm = JSON.parse(data);\n}\n\nfunction onClick(event) {\n  const clickTarget = event.target.closest('button');\n  if (!clickTarget) {\n    return;\n  }\n  const itemTarget = clickTarget.attributes.class.value;\n\n  switch (itemTarget) {\n    case 'basket-clear-container':\n      clearBasket();\n      break;\n    case 'delete-item-button':\n      const itemId = idDetect(event);\n      deleteSelectedItem(itemId);\n      getLocalStorageData();\n      itemsContainer.innerHTML = basketItemsMarkup(dataForm);\n      break;\n    case 'decrease-button':\n      if (!true) {\n      }\n      counterItem(event, -1);\n      break;\n    case 'increase-button':\n      counterItem(event, 1);\n      break;\n    default:\n  }\n}\n\nfunction clearBasket() {\n  dataForm = [];\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(dataForm));\n  countAddedItems(dataForm);\n}\n\nfunction countAddedItems(item) {\n  itemCount.textContent = item.length;\n  isBasketEmpty(item.length);\n}\n\nfunction deleteSelectedItem(item) {\n  for (let i = 0; i <= dataForm.length; i += 1) {\n    const { _id: itemId } = dataForm[i];\n    if (itemId === item) {\n      dataForm.splice(i, 1);\n      updateLocalStorageData(dataForm);\n      totalSumCount(dataForm);\n      return;\n    }\n  }\n}\n\nfunction idDetect(event) {\n  const parentItem = event.target.closest('li');\n  return parentItem.dataset.id;\n}\n\nfunction counterItem(event, increment) {\n  try {\n    const itemId = idDetect(event);\n    const parentItem = event.target.closest('div');\n    let item = Number(parentItem.children.counter.textContent) + increment;\n    parentItem.children.counter.textContent = item;\n    updateItemCount(itemId, item);\n    totalSumCount(dataForm);\n    // totalSum.textContent = `$${totalSumCount(dataForm)}`;\n    if (item <= 1) {\n      lockDecrese(parentItem);\n      return;\n    }\n    unlockDecrese(parentItem);\n  } catch (error) {\n    // add notifix message about something wrong\n    console.log(error.message);\n  }\n}\n\nfunction lockDecrese(parentItem) {\n  parentItem.children.decrease.children[0].classList.add('hide');\n  parentItem.children.decrease.disabled = true;\n}\n\nfunction unlockDecrese(parentItem) {\n  parentItem.children.decrease.children[0].classList.remove('hide');\n  parentItem.children.decrease.disabled = false;\n}\n\nfunction updateItemCount(item, count) {\n  for (let i = 0; i <= dataForm.length; i += 1) {\n    const { _id: itemId } = dataForm[i];\n    if (itemId === item) {\n      dataForm[i].count = count;\n      updateLocalStorageData(dataForm);\n      return;\n    }\n  }\n}\n\nfunction updateLocalStorageData(dataForm) {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(dataForm));\n}\n\nfunction isBasketEmpty(itemAdded) {\n  if (itemAdded === 0) {\n    emptyBasket.classList.remove('hide');\n    filledBasket.classList.add('hide');\n    return;\n  } else {\n    emptyBasket.classList.add('hide');\n    filledBasket.classList.remove('hide');\n  }\n}\n\nfunction basketItemsMarkup(array) {\n  return array\n    .map(\n      ({\n        _id: id,\n        name,\n        img,\n        category,\n        size,\n        is10PercentOff,\n        price,\n        count = 1,\n      }) =>\n        `\n        <li class=\"item-container\" data-id=\"${id}\">\n          <div class=\"item-img-link\">\n            <img class=\"item-img\" src=\"${img}\" alt=\"${name}\" loading=\"lazy\" />\n          </div>\n          <div class=\"item-info\">\n            <div class=\"item-title-container\">\n              <h4 class=\"item-title\">${name}</h4>\n              <button type=\"button\" class=\"delete-item-button\">\n                <svg class=\"delete-item-icon\" width=\"20\" height=\"20\">\n                  <use href=\"./images/icons.svg#delete-icon\"></use>\n                </svg>\n              </button>\n            </div>\n            <ul class=\"item-parameter-list\">\n              <li class=\"item-category\">Category:</li>\n              <li class=\"item-parameter\">${category}</li>\n              <li class=\"item-category\">Size:</li>\n              <li class=\"item-parameter\">${size}</li>\n            </ul>\n            <div class=\"total-item-container\">\n              <p class=\"item-price\">$${price}</p>\n              <div class=\"item-counter-container\">\n                <button class=\"decrease-button\" disabled name=\"decrease\" type=\"button\">\n                  <svg class=\"decrease-icon hide\" width=\"18\" height=\"18\">\n                    <use href=\"./images/icons.svg#minus\"></use>\n                  </svg>\n                </button>\n                <p class=\"item-counter\" name=\"counter\">${count}</p>\n                <button class=\"increase-button\" name=\"increase\" type=\"button\">\n                  <svg class=\"increase-icon\" width=\"18\" height=\"18\">\n                    <use href=\"./images/icons.svg#plus\"></use>\n                  </svg>\n                </button>\n              </div>\n            </div>\n          </div>\n        </li>\n        `\n    )\n    .join('');\n}\n\nfunction totalSumCount(array) {\n  let totalPrice = 0;\n  array.forEach(({ price, count = 1 }) => {\n    totalPrice += price * count;\n  });\n  totalSum.textContent = `$${totalPrice.toFixed(2)}`;\n}\n\n//  Email validation\nconst EMAIL_REGEXP =\n  /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@(([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{2,})$/iu;\nconst input = document.querySelector('.email-input');\n\nasync function onOrderSubmit(event) {\n  try {\n    event.preventDefault();\n    const email = event.target.elements.email.value;\n    if (!isEmailValid(email)) {\n      throw new Error(`Your E-mail is not valid`);\n    }\n\n    let order = [];\n    // if count abcent than 1\n    dataForm.forEach(({ _id: productId, count: amount = 1 }) => {\n      order.push({ productId, amount });\n    });\n    const apiResponse = await createNewOrder(email, order);\n\n    // add modal message about success\n    success(apiResponse);\n  } catch (error) {\n    // add modal message about something wrong\n    onError();\n  }\n}\nfunction isEmailValid(value) {\n  return EMAIL_REGEXP.test(value);\n}\n\nfunction success(response) {\n  // clearBasket();\n  checkoutForm.reset();\n\n  console.log(response);\n}\nfunction onError(response) {\n  console.log(response);\n}\n\nconst BASE_URL = 'https://food-boutique.b.goit.study/api/';\naxios.defaults.baseURL = BASE_URL;\n\nasync function createNewOrder(email, products) {\n  return await axios\n    .post(`${BASE_URL}orders`, {\n      email,\n      products,\n    })\n    .then(response => response.data);\n}\n"],"names":["STORAGE_KEY","dataForm","itemCount","emptyBasket","filledBasket","itemsContainer","totalSum","checkoutForm","itemButton","onOrderSubmit","onClick","addLocalStorageData","onLoad","getLocalStorageData","countAddedItems","basketItemsMarkup","totalSumCount","error","data","event","clickTarget","clearBasket","itemId","idDetect","deleteSelectedItem","counterItem","item","isBasketEmpty","i","updateLocalStorageData","increment","parentItem","updateItemCount","lockDecrese","unlockDecrese","count","itemAdded","array","id","name","img","category","size","is10PercentOff","price","totalPrice","EMAIL_REGEXP","email","isEmailValid","order","productId","amount","apiResponse","createNewOrder","success","onError","value","response","BASE_URL","axios","products"],"mappings":"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"}