{"version":3,"file":"commonHelpers.js","sources":["../src/images/icons.svg","../src/js/card.js"],"sourcesContent":["export default \"__VITE_ASSET__4a8417dd__\"","import sprite from '../images/icons.svg';\n// import { forEach } from 'lodash';\nimport { createNewOrder } from './get-api';\n\nconst STORAGE_KEY = 'added-item';\nlet dataForm = [];\n\nconst pathSvg = document.querySelector('.js-basket-icon');\nconst itemCount = document.querySelector('.js-item-count');\nconst emptyBasket = document.querySelector('.js-empty-basket');\nconst filledBasket = document.querySelector('.js-filled-basket');\nconst itemsContainer = document.querySelector('.js-items-container');\nconst totalSum = document.querySelector('.total-count-text');\nconst checkoutForm = document.querySelector('.js-checkout-form');\nconst itemButton = document.querySelector('.js-item-button');\nconst headerCount = document.querySelector('#countProducts');\n\nconst path = pathSvg.ownerDocument.location;\nconsole.dir(path);\n\ncheckoutForm.addEventListener('submit', onOrderSubmit);\nitemButton.addEventListener('click', onClick);\n\nonLoad();\n\nfunction onLoad() {\n  try {\n    getLocalStorageData();\n    countAddedItems(dataForm);\n\n    counterItem(event, 0);\n\n\n    itemsContainer.innerHTML = basketItemsMarkup(dataForm);\n    totalSumCount(dataForm);\n    // totalSum.textContent = `$${totalSumCount(dataForm)}`;\n  } catch (error) {\n    // add notifix message about something wrong\n    console.log(error.message);\n  }\n}\n\nfunction getLocalStorageData() {\n  const data = localStorage.getItem(STORAGE_KEY);\n  if (!data) return;\n  dataForm = JSON.parse(data);\n}\n\nfunction onClick(event) {\n  const clickTarget = event.target.closest('button');\n  if (!clickTarget) {\n    return;\n  }\n  const itemTarget = clickTarget.attributes.class.value;\n\n  switch (itemTarget) {\n    case 'basket-clear-container':\n      clearBasket();\n      break;\n    case 'delete-item-button':\n      const itemId = idDetect(event);\n      deleteSelectedItem(itemId);\n      getLocalStorageData();\n      itemsContainer.innerHTML = basketItemsMarkup(dataForm);\n      break;\n    case 'decrease-button':\n      if (!true) {\n      }\n      counterItem(event, -1);\n      break;\n    case 'increase-button':\n      counterItem(event, 1);\n      break;\n    default:\n  }\n}\n\nfunction clearBasket() {\n  dataForm = [];\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(dataForm));\n  countAddedItems(dataForm);\n}\n\nfunction countAddedItems(item) {\n  itemCount.textContent = item.length;\n  headerCount.textContent = `Cart (${item.length})`;\n  isBasketEmpty(item.length);\n}\n\nfunction deleteSelectedItem(item) {\n  for (let i = 0; i <= dataForm.length; i += 1) {\n    const { _id: itemId } = dataForm[i];\n    if (itemId === item) {\n      dataForm.splice(i, 1);\n      updateLocalStorageData(dataForm);\n      countAddedItems(dataForm);\n      totalSumCount(dataForm);\n      return;\n    }\n  }\n}\n\nfunction idDetect(event) {\n  const parentItem = event.target.closest('li');\n  return parentItem.dataset.id;\n}\n\nfunction counterItem(event, increment) {\n  try {\n    const itemId = idDetect(event);\n    const parentItem = event.target.closest('div');\n    let item = Number(parentItem.children.counter.textContent) + increment;\n    parentItem.children.counter.textContent = item;\n    updateItemCount(itemId, item);\n    totalSumCount(dataForm);\n    // totalSum.textContent = `$${totalSumCount(dataForm)}`;\n    if (item <= 1) {\n      lockDecrese(parentItem);\n      return;\n    }\n    unlockDecrese(parentItem);\n  } catch (error) {\n    // add notifix message about something wrong\n    console.log(error.message);\n  }\n}\n\nfunction lockDecrese(parentItem) {\n  parentItem.children.decrease.children[0].classList.add('hide');\n  parentItem.children.decrease.disabled = true;\n}\n\nfunction unlockDecrese(parentItem) {\n  parentItem.children.decrease.children[0].classList.remove('hide');\n  parentItem.children.decrease.disabled = false;\n}\n\nfunction updateItemCount(item, count) {\n  for (let i = 0; i <= dataForm.length; i += 1) {\n    const { _id: itemId } = dataForm[i];\n    if (itemId === item) {\n      dataForm[i].count = count;\n      updateLocalStorageData(dataForm);\n      return;\n    }\n  }\n}\n\nfunction updateLocalStorageData(dataForm) {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(dataForm));\n}\n\nfunction isBasketEmpty(itemAdded) {\n  if (itemAdded === 0) {\n    emptyBasket.classList.remove('hide');\n    filledBasket.classList.add('hide');\n    return;\n  } else {\n    emptyBasket.classList.add('hide');\n    filledBasket.classList.remove('hide');\n  }\n}\n\nfunction basketItemsMarkup(array) {\n  return array\n    .map(\n      ({\n        _id: id,\n        name,\n        img,\n        category,\n        size,\n        is10PercentOff,\n        price,\n        count = 1,\n      }) =>\n        `\n        <li class=\"item-container\" data-id=\"${id}\">\n          <div class=\"item-img-link\">\n            <img class=\"item-img\" src=\"${img}\" alt=\"${name}\" loading=\"lazy\" />\n          </div>\n          <div class=\"item-info\">\n            <div class=\"item-title-container\">\n              <h4 class=\"item-title\">${name}</h4>\n              <button type=\"button\" class=\"delete-item-button\">\n                <svg class=\"delete-item-icon\" width=\"20\" height=\"20\">\n                  <use href=\"${sprite}#delete-icon\"></use>\n                </svg>\n              </button>\n            </div>\n            <ul class=\"item-parameter-list\">\n              <li class=\"item-category\">Category:</li>\n              <li class=\"item-parameter\">${category}</li>\n              <li class=\"item-category\">Size:</li>\n              <li class=\"item-parameter\">${size}</li>\n            </ul>\n            <div class=\"total-item-container\">\n              <p class=\"item-price\">$${price}</p>\n              <div class=\"item-counter-container\">\n                <button class=\"decrease-button\" disabled name=\"decrease\" type=\"button\">\n                  <svg class=\"decrease-icon hide\" width=\"18\" height=\"18\">\n                    <use href=\"${sprite}#minus\"></use>\n                  </svg>\n                </button>\n                <p class=\"item-counter\" name=\"counter\">${count}</p>\n                <button class=\"increase-button\" name=\"increase\" type=\"button\">\n                  <svg class=\"increase-icon\" width=\"18\" height=\"18\">\n                    <use href=\"${sprite}#plus\"></use>\n                  </svg>\n                </button>\n              </div>\n            </div>\n          </div>\n        </li>\n        `\n    )\n    .join('');\n}\n\nfunction totalSumCount(array) {\n  let totalPrice = 0;\n  array.forEach(({ price, count = 1 }) => {\n    totalPrice += price * count;\n  });\n  totalSum.textContent = `$${totalPrice.toFixed(2)}`;\n}\n\n//  Email validation\nconst EMAIL_REGEXP =\n  /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@(([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{2,})$/iu;\nconst input = document.querySelector('.email-input');\n\nasync function onOrderSubmit(event) {\n  try {\n    event.preventDefault();\n    const email = event.target.elements.email.value;\n    if (!isEmailValid(email)) {\n      throw new Error(`Your E-mail is not valid`);\n    }\n\n    let order = [];\n    // if count abcent than 1\n    dataForm.forEach(({ _id: productId, count: amount = 1 }) => {\n      order.push({ productId, amount });\n    });\n    const apiResponse = await createNewOrder(email, order);\n\n    // add modal message about success\n    success(apiResponse);\n  } catch (error) {\n    // add modal message about something wrong\n    onError();\n  }\n}\nfunction isEmailValid(value) {\n  return EMAIL_REGEXP.test(value);\n}\n\nfunction success(response) {\n  clearBasket();\n  checkoutForm.reset();\n\n  console.log(response);\n}\nfunction onError(response) {\n  console.log(response);\n}\n\n// const BASE_URL = 'https://food-boutique.b.goit.study/api/';\n// axios.defaults.baseURL = BASE_URL;\n"],"names":["sprite","STORAGE_KEY","dataForm","pathSvg","itemCount","emptyBasket","filledBasket","itemsContainer","totalSum","checkoutForm","itemButton","headerCount","path","onOrderSubmit","onClick","onLoad","getLocalStorageData","countAddedItems","counterItem","basketItemsMarkup","totalSumCount","error","data","event","clickTarget","clearBasket","itemId","idDetect","deleteSelectedItem","item","isBasketEmpty","i","updateLocalStorageData","increment","parentItem","updateItemCount","lockDecrese","unlockDecrese","count","itemAdded","array","id","name","img","category","size","is10PercentOff","price","totalPrice","EMAIL_REGEXP","email","isEmailValid","order","productId","amount","apiResponse","createNewOrder","success","onError","value","response"],"mappings":"qFAAA,MAAeA,EAAA,6CCITC,EAAc,aACpB,IAAIC,EAAW,CAAA,EAEf,MAAMC,EAAU,SAAS,cAAc,iBAAiB,EAClDC,EAAY,SAAS,cAAc,gBAAgB,EACnDC,EAAc,SAAS,cAAc,kBAAkB,EACvDC,EAAe,SAAS,cAAc,mBAAmB,EACzDC,EAAiB,SAAS,cAAc,qBAAqB,EAC7DC,EAAW,SAAS,cAAc,mBAAmB,EACrDC,EAAe,SAAS,cAAc,mBAAmB,EACzDC,EAAa,SAAS,cAAc,iBAAiB,EACrDC,EAAc,SAAS,cAAc,gBAAgB,EAErDC,EAAOT,EAAQ,cAAc,SACnC,QAAQ,IAAIS,CAAI,EAEhBH,EAAa,iBAAiB,SAAUI,CAAa,EACrDH,EAAW,iBAAiB,QAASI,CAAO,EAE5CC,IAEA,SAASA,GAAS,CAChB,GAAI,CACFC,IACAC,EAAgBf,CAAQ,EAExBgB,EAAY,MAAO,CAAC,EAGpBX,EAAe,UAAYY,EAAkBjB,CAAQ,EACrDkB,EAAclB,CAAQ,CAEvB,OAAQmB,EAAP,CAEA,QAAQ,IAAIA,EAAM,OAAO,CAC1B,CACH,CAEA,SAASL,GAAsB,CAC7B,MAAMM,EAAO,aAAa,QAAQrB,CAAW,EACxCqB,IACLpB,EAAW,KAAK,MAAMoB,CAAI,EAC5B,CAEA,SAASR,EAAQS,EAAO,CACtB,MAAMC,EAAcD,EAAM,OAAO,QAAQ,QAAQ,EACjD,GAAI,CAACC,EACH,OAIF,OAFmBA,EAAY,WAAW,MAAM,MAE9B,CAChB,IAAK,yBACHC,IACA,MACF,IAAK,qBACH,MAAMC,EAASC,EAASJ,CAAK,EAC7BK,EAAmBF,CAAM,EACzBV,IACAT,EAAe,UAAYY,EAAkBjB,CAAQ,EACrD,MACF,IAAK,kBAGHgB,EAAYK,EAAO,EAAE,EACrB,MACF,IAAK,kBACHL,EAAYK,EAAO,CAAC,EACpB,KAEH,CACH,CAEA,SAASE,GAAc,CACrBvB,EAAW,CAAA,EACX,aAAa,QAAQD,EAAa,KAAK,UAAUC,CAAQ,CAAC,EAC1De,EAAgBf,CAAQ,CAC1B,CAEA,SAASe,EAAgBY,EAAM,CAC7BzB,EAAU,YAAcyB,EAAK,OAC7BlB,EAAY,YAAc,SAASkB,EAAK,UACxCC,EAAcD,EAAK,MAAM,CAC3B,CAEA,SAASD,EAAmBC,EAAM,CAChC,QAASE,EAAI,EAAGA,GAAK7B,EAAS,OAAQ6B,GAAK,EAAG,CAC5C,KAAM,CAAE,IAAKL,CAAQ,EAAGxB,EAAS6B,GACjC,GAAIL,IAAWG,EAAM,CACnB3B,EAAS,OAAO6B,EAAG,CAAC,EACpBC,EAAuB9B,CAAQ,EAC/Be,EAAgBf,CAAQ,EACxBkB,EAAclB,CAAQ,EACtB,MACD,CACF,CACH,CAEA,SAASyB,EAASJ,EAAO,CAEvB,OADmBA,EAAM,OAAO,QAAQ,IAAI,EAC1B,QAAQ,EAC5B,CAEA,SAASL,EAAYK,EAAOU,EAAW,CACrC,GAAI,CACF,MAAMP,EAASC,EAASJ,CAAK,EACvBW,EAAaX,EAAM,OAAO,QAAQ,KAAK,EAC7C,IAAIM,EAAO,OAAOK,EAAW,SAAS,QAAQ,WAAW,EAAID,EAK7D,GAJAC,EAAW,SAAS,QAAQ,YAAcL,EAC1CM,EAAgBT,EAAQG,CAAI,EAC5BT,EAAclB,CAAQ,EAElB2B,GAAQ,EAAG,CACbO,EAAYF,CAAU,EACtB,MACD,CACDG,EAAcH,CAAU,CACzB,OAAQb,EAAP,CAEA,QAAQ,IAAIA,EAAM,OAAO,CAC1B,CACH,CAEA,SAASe,EAAYF,EAAY,CAC/BA,EAAW,SAAS,SAAS,SAAS,GAAG,UAAU,IAAI,MAAM,EAC7DA,EAAW,SAAS,SAAS,SAAW,EAC1C,CAEA,SAASG,EAAcH,EAAY,CACjCA,EAAW,SAAS,SAAS,SAAS,GAAG,UAAU,OAAO,MAAM,EAChEA,EAAW,SAAS,SAAS,SAAW,EAC1C,CAEA,SAASC,EAAgBN,EAAMS,EAAO,CACpC,QAASP,EAAI,EAAGA,GAAK7B,EAAS,OAAQ6B,GAAK,EAAG,CAC5C,KAAM,CAAE,IAAKL,CAAQ,EAAGxB,EAAS6B,GACjC,GAAIL,IAAWG,EAAM,CACnB3B,EAAS6B,GAAG,MAAQO,EACpBN,EAAuB9B,CAAQ,EAC/B,MACD,CACF,CACH,CAEA,SAAS8B,EAAuB9B,EAAU,CACxC,aAAa,QAAQD,EAAa,KAAK,UAAUC,CAAQ,CAAC,CAC5D,CAEA,SAAS4B,EAAcS,EAAW,CAChC,GAAIA,IAAc,EAAG,CACnBlC,EAAY,UAAU,OAAO,MAAM,EACnCC,EAAa,UAAU,IAAI,MAAM,EACjC,MACJ,MACID,EAAY,UAAU,IAAI,MAAM,EAChCC,EAAa,UAAU,OAAO,MAAM,CAExC,CAEA,SAASa,EAAkBqB,EAAO,CAChC,OAAOA,EACJ,IACC,CAAC,CACC,IAAKC,EACL,KAAAC,EACA,IAAAC,EACA,SAAAC,EACA,KAAAC,EACA,eAAAC,EACA,MAAAC,EACA,MAAAT,EAAQ,CACT,IACC;AAAA,8CACsCG;AAAA;AAAA,yCAELE,WAAaD;AAAA;AAAA;AAAA;AAAA,uCAIfA;AAAA;AAAA;AAAA,+BAGR1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAMY4C;AAAA;AAAA,2CAEAC;AAAA;AAAA;AAAA,uCAGJE;AAAA;AAAA;AAAA;AAAA,iCAIN/C;AAAA;AAAA;AAAA,yDAGwBsC;AAAA;AAAA;AAAA,iCAGxBtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAQ5B,EACA,KAAK,EAAE,CACZ,CAEA,SAASoB,EAAcoB,EAAO,CAC5B,IAAIQ,EAAa,EACjBR,EAAM,QAAQ,CAAC,CAAE,MAAAO,EAAO,MAAAT,EAAQ,CAAC,IAAO,CACtCU,GAAcD,EAAQT,CAC1B,CAAG,EACD9B,EAAS,YAAc,IAAIwC,EAAW,QAAQ,CAAC,GACjD,CAGA,MAAMC,EACJ,8GACY,SAAS,cAAc,cAAc,EAEnD,eAAepC,EAAcU,EAAO,CAClC,GAAI,CACFA,EAAM,eAAc,EACpB,MAAM2B,EAAQ3B,EAAM,OAAO,SAAS,MAAM,MAC1C,GAAI,CAAC4B,EAAaD,CAAK,EACrB,MAAM,IAAI,MAAM,0BAA0B,EAG5C,IAAIE,EAAQ,CAAA,EAEZlD,EAAS,QAAQ,CAAC,CAAE,IAAKmD,EAAW,MAAOC,EAAS,KAAQ,CAC1DF,EAAM,KAAK,CAAE,UAAAC,EAAW,OAAAC,CAAQ,CAAA,CACtC,CAAK,EACD,MAAMC,EAAc,MAAMC,EAAeN,EAAOE,CAAK,EAGrDK,EAAQF,CAAW,CACpB,MAAC,CAEAG,GACD,CACH,CACA,SAASP,EAAaQ,EAAO,CAC3B,OAAOV,EAAa,KAAKU,CAAK,CAChC,CAEA,SAASF,EAAQG,EAAU,CACzBnC,IACAhB,EAAa,MAAK,EAElB,QAAQ,IAAImD,CAAQ,CACtB,CACA,SAASF,EAAQE,EAAU,CACzB,QAAQ,IAAIA,CAAQ,CACtB"}